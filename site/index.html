<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>booyah</title>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
/* ===========================
   COMPLETE STYLE REWRITE
   (drop-in replacement â€” visual only)
   =========================== */

/* --- reset + base --- */
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
html, body { height: 100%; }
body {
  font-family: "Barlow", "Inter", system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
  background:

    radial-gradient(circle, hsla(236, 91%, 61%, 1) 0%, hsla(228, 66%, 43%, 1) 51%, hsla(243, 66%, 13%, 1) 100%);

  color: #f3f7ff;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: flex;
  letter-spacing: 0.2px;
}

/* --- particle canvas --- */
#particle-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
  pointer-events: none;
  mix-blend-mode: screen;
  filter: blur(.4px) saturate(1.05);
}

/* =========================
   SETUP WIZARD (glassy neon)
   ========================= */
#setup-overlay{
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 6000;
  background: linear-gradient(180deg, rgba(2,6,20,0.75), rgba(2,4,18,0.86));
  backdrop-filter: blur(8px) saturate(120%);
}

.setup-card{
  width: 480px;
  padding: 30px;
  border-radius: 16px;
  background: linear-gradient(180deg, rgba(12,16,44,0.86), rgba(8,10,30,0.88));
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: 0 30px 80px rgba(6,8,30,0.7), inset 0 1px 0 rgba(255,255,255,0.02);
  text-align: center;
  transform: translateY(-6px);
}

.setup-step { display: none; }
.setup-step.active { display: block; animation: popIn .36s cubic-bezier(.2,.9,.2,1); }

h3 { font-weight: 700; color: #f7fbff; margin-bottom: 12px; text-shadow: 0 6px 30px rgba(120,80,255,0.04); }

/* icon grid */
.icon-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; margin: 18px 0; }
.icon-opt{
  padding: 14px;
  border-radius: 12px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  font-size:22px;
  color: #eff4ff;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03));
  border: 1px solid rgba(120,80,255,0.06);
  transition: transform .2s ease, box-shadow .2s ease, background .2s ease;
  box-shadow: 0 10px 30px rgba(6,8,30,0.5);
}
.icon-opt:hover { transform: translateY(-6px) scale(1.03); box-shadow: 0 20px 60px rgba(120,80,255,0.12); }
.icon-opt.selected {
  background: linear-gradient(90deg, rgba(255,92,184,0.12), rgba(57,218,255,0.06));
  border-color: rgba(255,255,255,0.12);
  color: #fff;
  box-shadow: 0 26px 84px rgba(120,80,255,0.18), inset 0 -6px 18px rgba(0,0,0,0.08);
}

/* inputs / buttons */
.setup-input{
  width:100%;
  padding:12px 14px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(10,12,30,0.54), rgba(6,8,20,0.54));
  color:#eef6ff;
  margin: 14px 0;
  outline: none;
  transition: box-shadow .14s ease, transform .12s ease, border-color .12s;
  box-shadow: 0 8px 26px rgba(6,8,30,0.45);
}
.setup-input:focus { transform: translateY(-3px); box-shadow: 0 20px 60px rgba(120,80,255,0.12); border-color: #9aa8ff; }

.setup-btn{
  padding: 12px 28px;
  border-radius: 12px;
  border: none;
  background: linear-gradient(180deg, #ff5ca8 0%, #8b5bff 100%);
  color: white;
  font-weight: 800;
  cursor:pointer;
  box-shadow: 0 18px 56px rgba(139,91,255,0.18), inset 0 -6px 16px rgba(0,0,0,0.15);
  transition: transform .16s ease, box-shadow .16s ease;
}
.setup-btn:hover { transform: translateY(-6px); box-shadow: 0 38px 100px rgba(139,91,255,0.26); }

/* =========================
   SIDEBAR (compact neon)
   ========================= */
.sidebar{
  width: 72px;
  height:100%;
  background: linear-gradient(180deg, rgba(6,8,30,0.98), rgba(2,4,18,0.98));
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:18px 0;
  border-right: 1px solid rgba(255,255,255,0.02);
  box-shadow: 8px 0 40px rgba(3,6,20,0.6);
  z-index:10;
}
.nav-item{
  width:46px;
  height:46px;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-bottom:14px;
  cursor:pointer;
  transition: transform .18s ease, box-shadow .18s ease, background .18s;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));
  color: #9fb1ff;
  border: 1px solid transparent;
}
.nav-item:hover { transform: translateY(-6px); box-shadow: 0 18px 48px rgba(120,80,255,0.08); color: #fff; }
.nav-item.active {
  background: linear-gradient(180deg, rgba(255,92,184,0.08), rgba(57,218,255,0.04));
  color: #fff; border-color: rgba(255,255,255,0.06); box-shadow: 0 26px 72px rgba(120,80,255,0.12);
}
.spacer { flex-grow:1; }
.nav-img { width:22px; height:22px; object-fit:contain; pointer-events:none; filter: drop-shadow(0 8px 24px rgba(0,0,0,0.6)); }

/* =========================
   MAIN CONTENT + VIEWS
   ========================= */
.main-content{
  flex-grow:1;
  position:relative;
  z-index:5;
  padding:28px;
  overflow-y:auto;
  -webkit-overflow-scrolling: touch;
}
.view-section { display:none; width:100%; height:100%; flex-direction:column; align-items:center; animation: fadeIn .4s ease; }
.view-section.active-view { display:flex; }

/* custom scrollbar */
.main-content::-webkit-scrollbar { width:10px; height:10px; }
.main-content::-webkit-scrollbar-track { background: transparent; }
.main-content::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg,#ff5ca8,#39daff);
  border-radius: 12px;
  box-shadow: inset 0 0 0 2px rgba(0,0,0,0.12);
}

/* =========================
   GRID + CARDS (remade)
   ========================= */
.grid-container { width:92%; max-width:1500px; padding-top:20px; }
.grid-title {
  font-size:2.4rem;
  font-weight:800;
  margin-bottom:16px;
  color: #fff;
  letter-spacing: -0.5px;
  padding-bottom:12px;
  border-bottom: 2px solid rgba(255,255,255,0.03);
  text-shadow: 0 8px 30px rgba(255,92,184,0.03);
}
.grid-wrapper { display:grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap:26px; }

/* card */
.card{
  position:relative;
  overflow:hidden;
  border-radius:16px;
  border: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(8,10,28,0.88), rgba(2,4,14,0.9));
  transition: transform .34s cubic-bezier(.2,.9,.2,1), box-shadow .34s, border-color .34s;
  min-height:160px;
}
.card:hover { transform: translateY(-16px) scale(1.01); box-shadow: 0 50px 140px rgba(6,8,30,0.8); border-color: rgba(255,92,184,0.10); }
.card-image{
  width:100%;
  aspect-ratio: 1 / 1;
  object-fit: cover;
  transition: transform .36s ease, filter .28s ease, opacity .28s ease;
  opacity: .96;
}
.card:hover .card-image { transform: scale(1.04); filter: saturate(1.16) contrast(1.06); opacity: 1; }
.card-info{
  position:absolute;
  bottom:0;
  left:0;
  width:100%;
  padding:16px;
  background: linear-gradient(0deg, rgba(0,0,0,0.85), transparent 60%);
  color: #fff;
  font-weight:700;
  letter-spacing:0.2px;
}

/* decorative sheen */
.card::after{
  content:"";
  position:absolute;
  left:-30%;
  top:-40%;
  width:160%;
  height:180%;
  pointer-events:none;
  background: radial-gradient(60% 40% at 8% 8%, rgba(255,255,255,0.02), transparent 12%);
}

/* =========================
   EMBED IFRAME
   ========================= */
.embed-container { width:90%; max-width:1400px; padding-top:12px; }
.embed-iframe{
  width:100%;
  height: calc(100vh - 200px);
  border-radius:14px;
  border: 1px solid rgba(255,255,255,0.03);
  background:#000;
  box-shadow: 0 40px 120px rgba(3,6,20,0.8);
  display:block;
}

/* =========================
   MODAL + CONTROLS (controls above)
   ========================= */
.modal-overlay{
  position: fixed;
  inset: 0;
  display: none;
  z-index: 2000;
  justify-content: center;
  align-items: center;
  background: linear-gradient(180deg, rgba(0,0,0,0.56), rgba(0,0,0,0.75));
  backdrop-filter: blur(6px) saturate(120%);
}
.modal-window{
  width: 86vw;
  height: 86vh;
  background: linear-gradient(180deg, #03021a 0%, #000 100%);
  border-radius: 18px;
  position: relative;
  overflow: visible; /* so controls can sit above edge */
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 60px 160px rgba(0,0,0,0.85), inset 0 1px 0 rgba(255,255,255,0.02);
  display:flex;
  flex-direction:column;
}

/* controls sit above the modal window, next to each other */
.window-controls{
  position: absolute;
  top: -28px;
  right: 20px;
  z-index: 2600;
  display:flex;
  gap:10px;
  transform: translateZ(0);
}

.win-btn{
  width:40px;
  height:40px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
  font-size:0.95rem;
  cursor:pointer;
  border:none;
  color:#fff;
  box-shadow: 0 12px 36px rgba(0,0,0,0.6);
  transition: transform .14s ease, box-shadow .14s ease;
}
.win-btn:hover{ transform: translateY(-4px); box-shadow: 0 24px 56px rgba(0,0,0,0.7); }
.close-btn{ background: radial-gradient(circle, hsla(0, 90%, 61%, 1) 0%, hsla(0, 100%, 33%, 1) 100%); }
.min-btn{ background: radial-gradient(circle, hsla(40, 70%, 46%, 1) 0%, hsla(50, 100%, 50%, 1) 100%); }

/* =========================
   ALBUM / TRACKS
   ========================= */
.album-view{
  display:flex;
  width:100%;
  height:100%;
  background: linear-gradient(135deg, rgba(20,12,60,0.98), rgba(0,0,0,0.96));
}
.album-art-large{ width:40%; background-size:cover; background-position:center; border-right: 1px solid rgba(255,255,255,0.02); }
.album-tracks{ width:60%; padding:22px; overflow-y:auto; color:#e9f6ff; }
.album-tracks::-webkit-scrollbar{ width:8px; }
.album-tracks::-webkit-scrollbar-thumb{ background: linear-gradient(180deg,#ff5ca8,#39daff); border-radius:10px; }

/* track items */
.track-item{
  padding:14px;
  border-bottom: 1px solid rgba(255,255,255,0.02);
  display:flex;
  align-items:center;
  justify-content:space-between;
  cursor:pointer;
  transition: transform .12s ease, background .12s ease;
}
.track-item:hover{ transform: translateX(6px); background: linear-gradient(90deg, rgba(255,92,184,0.04), rgba(57,218,255,0.02)); color:#fff; }

/* =========================
   MINI PLAYER
   ========================= */
#mini-player{
  position: fixed;
  bottom: 22px;
  left: 86px;
  width:128px;
  height:128px;
  border-radius:14px;
  overflow:hidden;
  display:none;
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 38px 110px rgba(6,8,30,0.85);
  background-size: cover;
  background-position: center;
  transition: transform .22s cubic-bezier(.2,.9,.2,1), box-shadow .22s;
}
#mini-player:hover{ transform: translateY(-10px); box-shadow: 0 56px 160px rgba(0,0,0,0.9); }

.mini-controls{
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background: linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.6));
  opacity:0;
  transition: opacity .28s;
}
#mini-player:hover .mini-controls{ opacity:1; }

.mini-btn-row{ display:flex; gap:12px; margin-top:6px; }
.mini-btn{ color:#fff; cursor:pointer; font-size:1.15rem; transition: transform .12s ease; }
.mini-btn:hover{ transform:scale(1.08); }

/* =========================
   GAME IFRAME
   ========================= */
.game-iframe{
  width:100%;
  height:100%;
  border:none;
  display:block;
  object-fit:fill;
  background:#000;
}

/* =========================
   UTILS + ANIMATIONS
   ========================= */
.nav-img{ width:22px; height:22px; object-fit:contain; pointer-events:none; }
@keyframes popIn { 0% { opacity:0; transform: translateY(10px) scale(.995); } 100% { opacity:1; transform:translateY(0) scale(1); } }
@keyframes fadeIn { from { opacity:0; transform: translateY(10px); } to { opacity:1; transform: translateY(0); } }
</style>



</head>
<body>

    <!-- SETUP WIZARD -->
    <div id="setup-overlay">
        <div class="setup-card">
            <div id="step-1" class="setup-step active">
                <h3>Choose a Cloak Icon</h3>
                <div class="icon-grid">
                    <div class="icon-opt" onclick="selIcon(this, 'https://google.com/favicon.ico')"><i class="fab fa-google"></i></div>
                    <div class="icon-opt" onclick="selIcon(this, 'https://drive.google.com/favicon.ico')"><i class="fab fa-google-drive"></i></div>
                    <div class="icon-opt" onclick="selIcon(this, 'https://classroom.google.com/favicon.ico')"><i class="fas fa-graduation-cap"></i></div>
                    <div class="icon-opt" onclick="selIcon(this, 'https://clever.com/favicon.ico')"><i class="fas fa-infinity"></i></div>
                    <div class="icon-opt" onclick="selIcon(this, 'https://canvas.instructure.com/favicon.ico')"><i class="fas fa-book"></i></div>
                    <div class="icon-opt" onclick="selIcon(this, 'https://wikipedia.org/favicon.ico')"><i class="fab fa-wikipedia-w"></i></div>
                </div>
                <button class="setup-btn" onclick="nextStep(2)">Next</button>
            </div>
            <div id="step-2" class="setup-step">
                <h3>Tab Title Cloak</h3>
                <input type="text" id="cloak-text" class="setup-input" placeholder="e.g. My Drive - Google">
                <button class="setup-btn" onclick="nextStep(3)">Next</button>
            </div>
            <div id="step-3" class="setup-step">
                <h3>Panic Settings</h3>
                <select id="panic-url" class="setup-input">
                    <option value="https://clever.com">Clever</option>
                    <option value="https://classroom.google.com">Google Classroom</option>
                    <option value="https://khanacademy.org">Khan Academy</option>
                </select>
                <input type="text" id="panic-key" class="setup-input" maxlength="1" placeholder="Panic Key (e.g. P)">
                <button class="setup-btn" onclick="finishSetup()">Submit & Save</button>
            </div>
        </div>
    </div>

    <canvas id="particle-canvas"></canvas>

    <!-- SIDEBAR -->
    <nav class="sidebar">
        <div class="nav-item active" id="btn-home" onclick="switchTab('home')"><img src="https://raw.githubusercontent.com/xxuep/games/main/web/hosusueue.png" class="nav-img"></div>
        <div class="nav-item" id="btn-games" onclick="switchTab('games')"><img src="https://raw.githubusercontent.com/xxuep/games/main/Untitled731_20251218145131.png" class="nav-img"></div>
     <!--   <div class="nav-item" id="btn-music" onclick="switchTab('music')"><img src="https://raw.githubusercontent.com/xxuep/games/main/music/Untitled732_20251218184220.png" class="nav-img"></div> -->

        <!-- NORMAL SIDEBAR BUTTON: switches tab AND loads HTML into iframe via srcdoc -->
        <div class="nav-item" id="btn-2048"
             onclick="switchTab('2048'); loadHTML('https://raw.githubusercontent.com/xxuep/games/main/web/soundboard.html','iframe-2048')">
            <img src="https://raw.githubusercontent.com/xxuep/games/main/web/myinbsranbredbuttobbn.png" class="nav-img">
        </div>

    </nav>

    <!-- MINI PLAYER -->
    <div id="mini-player">
        <div class="mini-controls">
            <div style="font-size: 10px; margin-bottom: 5px;">NOW PLAYING</div>
            <div class="mini-btn-row">
                <i class="fas fa-backward mini-btn" onclick="prevSong()"></i>
                <i id="mini-play-btn" class="fas fa-pause mini-btn" onclick="toggleMusic()"></i>
                <i class="fas fa-forward mini-btn" onclick="nextSong()"></i>
            </div>
        </div>
    </div>

    <!-- MAIN -->
    <main class="main-content">
        <!-- HOME VIEW -->
        <div id="view-home" class="view-section active-view">
            <h1 style="font-size: 4rem; color: #4F64FF; margin-top: 20vh;">ghost</h1>
            <p style="color: #ccc;">booyah!</p>
        </div>

        <!-- GAMES VIEW -->
        <div id="view-games" class="view-section">
            <div class="grid-container">
                <h2 class="grid-title">Game Library</h2>
                <div class="grid-wrapper" id="games-grid">
                    <!-- GAME CARDS GENERATED BY SCRIPT -->
                </div>
            </div>
        </div>

        <!-- MUSIC VIEW -->
        <div id="view-music" class="view-section">
            <div class="grid-container">
                <h2 class="grid-title">Music Library</h2>
                <div class="grid-wrapper">
                    <div class="card" onclick="openAlbum('album1')">
                        <img src="https://raw.githubusercontent.com/xxuep/games/main/web/ghosticon.png" class="card-image">
                        <div class="card-info"><b>Coming Soon</b></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EMBED VIEW: Soundboard -->
        <div id="view-2048" class="view-section">
            <div class="embed-container">
                <h2 class="grid-title">Soundboard</h2>
                <!-- this iframe will receive srcdoc (no sandbox) so clicks & scripts work -->
                <iframe id="iframe-2048" class="embed-iframe" allow="autoplay; fullscreen"></iframe>
            </div>
        </div>
    </main>

    <!-- MODAL (kept intact) -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-window">
            <div class="window-controls">
                <button class="win-btn min-btn" onclick="minimizeModal()">-</button>
                <button class="win-btn close-btn" onclick="closeModal()">X</button>
            </div>
            <div id="modal-body" style="width:100%; height:100%;"></div>
        </div>
    </div>

    <script>
        /* ======================
           SETUP / CLOAK / PANIC
           ====================== */
        let selectedFavicon = '';
        if(localStorage.getItem('brix-setup')) {
            document.getElementById('setup-overlay').style.display = 'none';
            applyCloak();
        }

        function selIcon(el, url) {
            document.querySelectorAll('.icon-opt').forEach(i => i.classList.remove('selected'));
            el.classList.add('selected');
            selectedFavicon = url;
        }

        function nextStep(step) {
            document.querySelectorAll('.setup-step').forEach(s => s.classList.remove('active'));
            document.getElementById('step-' + step).classList.add('active');
        }

        function finishSetup() {
            const data = {
                icon: selectedFavicon || 'https://google.com/favicon.ico',
                title: document.getElementById('cloak-text').value || 'Classes',
                panicUrl: document.getElementById('panic-url').value,
                panicKey: (document.getElementById('panic-key').value || 'P').toUpperCase()
            };
            localStorage.setItem('brix-setup', JSON.stringify(data));
            document.getElementById('setup-overlay').style.display = 'none';
            applyCloak();
        }

        function applyCloak() {
            const data = JSON.parse(localStorage.getItem('brix-setup') || '{}');
            if(!data) return;
            document.title = data.title || document.title;
            let link = document.querySelector("link[rel*='icon']") || document.createElement('link');
            link.type = 'image/x-icon'; link.rel = 'shortcut icon'; link.href = data.icon || link.href;
            document.getElementsByTagName('head')[0].appendChild(link);
            window.addEventListener('keydown', (e) => {
                if(e.shiftKey && e.key.toUpperCase() === (data.panicKey || 'P')) window.location.href = data.panicUrl || window.location.href;
            });
        }

        /* ======================
           NAVIGATION: tabs
           ====================== */
        function switchTab(tab) {
            document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active-view'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            const btn = document.getElementById('btn-' + tab);
            if(btn) btn.classList.add('active');
            const view = document.getElementById('view-' + tab);
            if(view) view.classList.add('active-view');
        }

        /* ======================
           GAME LIST (full list restored)
           ====================== */
        const games = [
    { title: '10 Minutes Till Dawn', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/10minutestilldawn.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/10-minutes-till-dawn_1x1.jpeg' },
    { title: '12 Mini Battles', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/12minibattles.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/12minibattles.png' },
    { title: '1 on 1 Soccer', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/1on1soccer.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/1-on-1-soccer.jpg' },
    { title: '1 on 1 Tennis', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/1on1tennis.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/1on1tennis.jpg' },
    { title: '1v1.LOL', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/1v1.lol.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/1v1%20loo.jpeg' },
    { title: '2048', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/2048.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/2048logo.jpeg' },
    { title: '3d Flight Simulator', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/3Dflightsimulator.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/3dflight.jpeg' },
    { title: 'Agar.io Lite', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/agariolite.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/agario.png' },
    { title: 'Age of War', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/ageofwar.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/ageofwar.jpeg' },
    { title: 'Age of War 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/ageofwar2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/ageofwar2.jpg' },
    { title: 'Ages of Conflict', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/agesofconflict.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/ages%20of%20conflict.png' },
    { title: 'Among Us', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/amongus.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/amongssusss.png' },
    { title: 'Angry Birds', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/angrybirds.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/angybirds.jpg' },
    { title: 'Awesome Tanks', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/awesometanks.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/awesome-tanks-game-icon.png' },
    { title: 'Awesome Tanks 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/awesometanks2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/awesome-tanks-2-icon.png' },
    { title: 'Backrooms', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/backrooms.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/horror/backroooooooooooooooomsss.jpg' },
    { title: 'Bacon May Die', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/baconmaydie.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/baconmaydieeee.jpeg' },
    { title: 'Bad Parenting', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/badparenting.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/horror/image_2025-12-13_193351410.png' },
    { title: "Baldi's Basics", url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/baldisbasics.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/baldis%20basif.jpg' },
    { title: 'Baseball Bros', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/baseballbros.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/baseballbross.jpg' },
    { title: 'Basketball Legends', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/basketballlegends.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/basketball-legends-2020.jpg' },
    { title: 'Basketball Stars', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/basketballstars.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/basketball-stars1-m240x240.jpg' },
    { title: 'Basket Bros', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/basketbros.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/basket-bros.jpg' },
    { title: 'Basket Random', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/basketrandom.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/basket-random_16x9-cover.png' },
    { title: 'Battle Cats (truffled is down)', url: 'https://raw.githubusercontent.com/xxuep/games/main/truffled/battlecats.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/battlecats.jpg' },
    { title: 'Bitlife', url: 'https://raw.githubusercontent.com/xxuep/games/main/bitlife.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/bitlfieee.png' },
    { title: 'Bow Masters', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/bowmasters.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/bowmasterssss.jpeg' },
    { title: 'Boxing Random', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/boxingrandom.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/boxing-random_1x1.jpeg' },
    { title: 'Candy Crush', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/candycrush.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/candy%20cruhsss.jpeg' },
    { title: 'Clash of Clans (truffled is down)', url: 'https://raw.githubusercontent.com/xxuep/games/main/truffled/clashofclans.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/clashofclans.jpeg' },
    { title: 'Clash Royale (truffled is down)', url: 'https://raw.githubusercontent.com/xxuep/games/main/truffled/clashroyale.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/clashroyale.jpeg' },
    { title: 'Cookie Clicker', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/cookieclicker.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/cookieclickerlogoyk.jpg' },
    { title: 'Crazy Cattle 3D', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/crazycattle3D.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/crazy-cattle-game.jpeg' },
    { title: 'Crossy Road', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/crossyroad.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/crossyroaddd.jpg' },
    { title: 'Drift Boss', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/driftboss.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/diftbosssssssss.jpeg' },
    { title: 'Drive Mad', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/drivemad.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/drivemaddddddddd.jpeg' },
    { title: 'Escape Road', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/escaperoad.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/escapppre5r6tfujk.jpeg' },
    { title: 'Escape Road 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/escaperoad2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/escapeppridoaoaod2222.jpeg' },
    { title: 'Flappy Bird', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/flappybird.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/flappyboirdd.jpeg' },
    { title: 'FNAF 1', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/fnaf.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/fnannfnfn1111.jpeg' },
    { title: 'FNAF 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/fnaf2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/fnaf2222222.jpeg' },
    { title: 'FNAF 3', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/fnaf3.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/fnaffffffff3.jpeg' },
    { title: 'FNAF 4', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/fnaf4.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/fnafaffafafff44444.jpeg' },
    { title: 'FNAF 5', url: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnaf5.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnaf55555555555.png' },
    { title: 'FNAF 6', url: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnaf6.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnaf666666666.jpg' },
    { title: 'FNAF UCN', url: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnafucn1.html'
, img: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnafucn.jpeg' },
    { title: 'FNAF World', url: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnafworld1.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/fnaf/fnafworld.jpeg' },
    { title: 'Football Bros', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/footballbros.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/footballbross.jpeg' },
    { title: 'Football Legends', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/footballlegends.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/footballlegendss.jpeg' },
    { title: 'Fruit Ninja', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/fruitninja.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/fruitititititninjjajaa.jpeg' },
    { title: 'Geometry Dash', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/geometrydashlite.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/geometrydashhshshs.jpeg' },
    { title: 'Granny', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/granny.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/grannyy.jpeg' },
    { title: 'Granny 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/granny2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/granny22.jpeg' },
    { title: 'Happy Wheels', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/happywheels.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/haopyweehsl.jpeg' },
    { title: 'Hole.io', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/holeio.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/holeeee.iuoooooo.jpeg' },
    { title: 'Johnny Trigger', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/johnnytrigger.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/johhhnynynynyntighg].jpeg' },
    { title: 'Level Devil', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/leveldevil.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/leveleleldeviil.jpeg' },
    { title: 'Melon Playground', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/melonplayground.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/melonplaygroudndddd.png' },
    { title: 'Monkey Mart', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/monkeymart.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/monkeymarrttttt.jpeg' },
    { title: 'MotoX3M', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/motox3m.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/motoox3mmm.jpeg' },
    { title: 'MotoX3M 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/motox3m2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/mtotox3mmmm2222.jpg' },
    { title: 'MotoX3M 3', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/motox3m3.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/motoootx3mmmm3333.jpg' },
    { title: 'Paper.io', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/paperio2.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/paper-io-2_16x9-cover.png' },
    { title: 'Plants VS Zombies', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/plantsvszombies.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/pvzzzzzzzz.jpeg' },
    { title: 'Ragdoll Archers', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/ragdollarchers.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/ragdollarchererss.jpeg' },
    { title: 'Retro Bowl', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/retrobowl.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/retroroobowollwlwl.jpeg' },
    { title: 'Slope', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/slope.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/slopepeppee.jpeg' },
    { title: 'Slow Roads', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/slowroads.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/slow-roads.jpg' },
    { title: 'Snow Rider', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/snowrider.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/snowriderrss.jpeg' },
    { title: 'Soccer Random', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/soccerrandom.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/soccerrandom.jpeg' },
    { title: 'Stick Man Hook', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/stickmanhook.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/stick-hook-game1.png' },
    { title: 'Super Hot', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/superhot.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/superhot.jpeg' },
    { title: 'Tag', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/tag.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/tag-online.png' },
    { title: 'Temple Run 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/templerun2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/templerun2.png' },
    { title: 'Time Shooter 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/timeshooter2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/timeshooter2.jpeg' },
    { title: 'Time Shooter 3', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/timeshooter3.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/timeshooter3.jpeg' },
    { title: 'Tiny Fishing', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/tinyfishing.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/tinyfishing.jpg' },
    { title: 'Tomb of the Mask', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/tombofthemask.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/tombofthemask.png' },
    { title: 'Vex 4', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/vex4.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/vex4.jpeg' },
    { title: 'Vex 5', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/vex5.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/vex5.jpeg' },
    { title: 'Vex 6', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/vex6.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/vex6.jpeg' },
    { title: 'Vex 7', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/vex7.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/vex7.jpeg' },
    { title: 'Vex 8', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/vex8.htm', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/vex8.jpeg' },
    { title: 'Volley Random', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/volleyrandom.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/volleyrandom.jpeg' },
    { title: 'Wheely', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely1.jpeg' },
    { title: 'Wheely 2', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely2.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely2.jpeg' },
    { title: 'Wheely 3', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely3.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely3.jpeg' },
    { title: 'Wheely 4', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely4.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely4.jpeg' },
    { title: 'Wheely 5', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely5.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely5.jpeg' },
    { title: 'Wheely 6', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely6.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely6.jpg' },
    { title: 'Wheely 7', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely7.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely7.jpg' },
    { title: 'Wheely 8', url: 'https://raw.githubusercontent.com/CoolDude2349/Offline-HTML-Games-Pack/master/offline/wheely8.html', img: 'https://raw.githubusercontent.com/xxuep/games/main/images/wheely8.jpg' }
        ];

        // generate cards
        const gridWrapper = document.getElementById('games-grid');
        gridWrapper.innerHTML = '';
        games.forEach(game => {
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => launchGame(game.url);

            const img = document.createElement('img');
            img.src = game.img;
            img.className = 'card-image';
            img.style.aspectRatio = '2/1';

            const info = document.createElement('div');
            info.className = 'card-info';
            info.innerHTML = `<b>${game.title}</b>`;

            card.appendChild(img);
            card.appendChild(info);
            gridWrapper.appendChild(card);
        });

        /* ======================
           MODAL GAME LAUNCHER (fixed)
           ====================== */
        const modal = document.getElementById('modal-overlay');
        const body = document.getElementById('modal-body');

async function launchGame(gameUrl) {
    if (!audioPlayer.paused) audioPlayer.pause();
    updateMiniPlayerState(false);

    modal.style.display = 'flex';
    body.innerHTML = '';

    const iframe = document.createElement('iframe');
    iframe.className = 'game-iframe';

    // FIX: Remove or set proper sandbox permissions
    // Removing it entirely is best for compatibility with diverse games
    iframe.removeAttribute('sandbox');
    iframe.setAttribute('allow', 'autoplay; fullscreen; keyboard-attribute; microphone');

    try {
        const r = await fetch(gameUrl, { mode: 'cors' });
        if (!r.ok) throw new Error('fetch failed');
        const html = await r.text();

        // Use the base tag to fix relative links for styles/images/scripts
        const baseHref = gameUrl.replace(/\/[^\/]*$/, '/');
        iframe.srcdoc = `<base href="${baseHref}">${html}`;
    } catch (e) {
        console.warn('Fetch failed, falling back to direct source:', e);
        iframe.src = gameUrl;
    }

    body.appendChild(iframe);
}

        function minimizeModal() { modal.style.display = 'none'; }
        function closeModal() {
            audioPlayer.pause();
            document.getElementById('mini-player').style.display = 'none';
            modal.style.display = 'none';
            body.innerHTML = '';
        }

        /* ======================
           loadHTML: fetch html and inject into named iframe via srcdoc
           - preserves relative asset loading via <base>
           - does NOT sandbox the iframe (so clicks & scripts work)
           ====================== */
        async function loadHTML(url, iframeId) {
            const iframe = document.getElementById(iframeId);
            if(!iframe) {
                console.error('iframe not found:', iframeId);
                return;
            }

            // show a temporary blank while loading
            iframe.src = 'about:blank';

            try {
                const res = await fetch(url, { mode: 'cors' });
                if(!res.ok) throw new Error('fetch failed: ' + res.status);
                let html = await res.text();

                // compute base so relative links/scripts/images resolve
                const baseURL = url.substring(0, url.lastIndexOf('/') + 1);
                html = `<base href="${baseURL}">` + html;

                // inject into iframe via srcdoc (no sandbox)
                iframe.removeAttribute('sandbox');
                iframe.srcdoc = html;
            } catch (err) {
                console.error('Failed to load HTML via fetch, falling back to direct src:', err);
                // fallback to direct src - note: raw.githubusercontent.com won't allow framing,
                // but this fallback is here for other hosts
                iframe.src = url;
            }
        }

        /* ======================
           MUSIC SYSTEM (kept as working stub)
           ====================== */
        const musicData = {
            'album1': {
                title: "Coming Soon",
                art: "https:/raw.githubusercontent.com/xxuep/games/main/web/ghosticon.png",
                songs: [
                   
                ]
            }
        };

        let currentAlbumId = null;
        let currentSongIndex = 0;
        let audioPlayer = new Audio();
        let isMusicModalOpen = false;

        function openAlbum(albumId) {
            isMusicModalOpen = true;
            modal.style.display = 'flex';
            const album = musicData[albumId];
            
            let tracksHTML = '';
            album.songs.forEach((song, index) => {
                tracksHTML += `<div class="track-item" onclick="playSong('${albumId}', ${index})">
                    <span>${index + 1}. ${song.title}</span>
                    <span><i class="fas fa-play"></i></span>
                </div>`;
            });

            body.innerHTML = `<div class="album-view">
                <div class="album-art-large" style="background-image: url('${album.art}')"></div>
                <div class="album-tracks"><h2>${album.title}</h2>${tracksHTML}</div>
            </div>`;
        }

        function playSong(albumId, index) {
            currentAlbumId = albumId;
            currentSongIndex = index;
            const song = musicData[albumId].songs[index];
            audioPlayer.src = song.url;
            audioPlayer.play().catch(()=>{ /* may require user gesture */});
            updateMiniPlayer();
            updateMiniPlayerState(true);
        }

        function updateMiniPlayer() {
            const mini = document.getElementById('mini-player');
            mini.style.display = 'block';
            if (currentAlbumId) mini.style.backgroundImage = `url('${musicData[currentAlbumId].art}')`;
        }

        function toggleMusic() {
            if(audioPlayer.paused) { audioPlayer.play().catch(()=>{}); updateMiniPlayerState(true); }
            else { audioPlayer.pause(); updateMiniPlayerState(false); }
        }

        function updateMiniPlayerState(isPlaying) {
            document.getElementById('mini-play-btn').className = isPlaying ? "fas fa-pause mini-btn" : "fas fa-play mini-btn";
        }

        function nextSong() {
            if(!currentAlbumId) return;
            currentSongIndex = (currentSongIndex + 1) % musicData[currentAlbumId].songs.length;
            playSong(currentAlbumId, currentSongIndex);
        }

        function prevSong() {
            if(!currentAlbumId) return;
            currentSongIndex = (currentSongIndex - 1 + musicData[currentAlbumId].songs.length) % musicData[currentAlbumId].songs.length;
            playSong(currentAlbumId, currentSongIndex);
        }

        audioPlayer.onended = nextSong;

        /* ======================
           PARTICLES (unchanged)
           ====================== */
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        let pts = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.onresize = resize; resize();
        class Particle {
            constructor() { this.reset(); }
            reset() { this.x = Math.random()*canvas.width; this.y = Math.random()*canvas.height; this.vx = (Math.random()-0.5)*0.3; this.vy = (Math.random()-0.5)*0.3; this.s = Math.random()*2; }
            up() { this.x+=this.vx; this.y+=this.vy; if(this.x<0)this.x=canvas.width; if(this.y<0)this.y=canvas.height; if(this.x>canvas.width)this.x=0; if(this.y>canvas.height)this.y=0; }
            dr() { ctx.fillStyle = "rgba(255,255,255,0.4)"; ctx.beginPath(); ctx.arc(this.x,this.y,this.s,0,6.28); ctx.fill(); }
        }
        for(let i=0; i<100; i++) pts.push(new Particle());
        function anim() { ctx.clearRect(0,0,canvas.width,canvas.height); pts.forEach(p=>{p.up(); p.dr();}); requestAnimationFrame(anim); }
        anim();

        /* ======================
           Initialize: set default tab
           ====================== */
        switchTab('home');
    </script>
</body>
</html>
